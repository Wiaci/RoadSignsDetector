# Прототип помощника для водителей
## _The Last Driver Assistant Prototype, Ever_

[![N|Solid](https://thumb.cloud.mail.ru/weblink/thumb/xw1/YJQf/xPBprpfjN)](https://platinum-flame-ea1.notion.site/c247aa22cd404670ae38eba351452ece?pvs=4)

[Описание процесса разработки](https://platinum-flame-ea1.notion.site/c247aa22cd404670ae38eba351452ece?pvs=4)

> In the realm where pixels meet prudence,
> 
> traffic signs are the beacons of safety,
> 
> and object detection becomes the guardian angel of seamless navigation,
> 
> weaving technology and traffic into a tapestry of secure passage.

## Описание проекта
Проект создан для точного и быстрого распознавания дорожных знаков в различных условиях освещения и погоды, информирования водителя об ограничениях скорости, запретах, предупреждениях и других важных указаниях на дороге.

Модель распознавания знаков дорожного движения на вход получает видео и в режиме реального времени обрабатывает его, детектируя и распознавая тип знаков по наибольшему соответствию.

## Бизнес цель
Бизнес-цель проекта — разработать надежную и эффективную робастную модель для обнаружения объектов дорожных знаков в реальном времени, повышающую точность распознавания в различных условиях освещения и погодных условиях. Целью этой модели является предоставление водителям своевременной информации об ограничениях скорости, запретах, предупреждениях и других важных инструкциях на дороге.

Улучшение: для дальнейшего улучшения этой цели рассмотреть возможность включения конкретных показателей производительности, таких как степень точности или время отклика, а также описание потенциального влияния на безопасность водителей и общую осведомленность о дороге. Кроме того, указание целевых платформ (например, автономных транспортных средств, автомобильных систем) и любых соответствующих нормативных стандартов может обеспечить более полное понимание масштабов проекта.

## Baseline
Была разработана базовая модель, основанная на YOLOv8 и обученная на [russian-traffic-signs-recognition dataset] в течение 100 эпох, чтобы проверить её работоспособность.

Для тестирования эффективности модели использовалась mAP@50 метрика.
Первоначальная система достигла mAP@50 больше 50, гаромническое среднее F1 больше 0.5 при confidence = 0.2. Однако модель была улучшена подбором гиперпараметров модели и включением в себя аугментированных изображений, что привело к увеличению метрики mAP@50 до ???.

## MVP
Для реализации проекта был проведен сбор данных, при котором было решено использовать датасет [russian-traffic-signs-recognition dataset]. Данный выбор обусловлен тем, что он содержит достаточное количество данных о российских знаках и представляет собой репрезентативный набор данных с чёткими изображениями специально для модели YOLOv8 в том числе.

Затем были рассмотрены различные варианты датасетов [mapillary dataset](https://www.mapillary.com/dataset/trafficsign), [russian-traffic-signs-recognition dataset] и различные архитектуры моделей. Были изучены датасеты  модели YOLOv8, SSD MobileNet v3 (Small и Large версии). В результате было принято решение использовать архитектуру YOLOv8 и обучать модель на датасете [russian-traffic-signs-recognition dataset]. Далее работа модели была проверена на видео Russia Crush, используя метрику mAP@50.

Было разработано веб-приложение с использованием библиотеки React и создан пользовательский интерфейс для его демонстрации. Впоследствии люди, используя мобильное приложение, могут узнать о приближающемся предупреждении или иной дорожной информации.

Пользовательский интерфейс представляет собой приложение, где пользователи могут узнать о предупреждающих знаках, например, в условиях непогоды.

## Фреймворки/библиотеки

Для правильной работы наше приложение использует ряд фреймворков с открытым исходным кодом:
[React](https://react.dev/reference/react)
[Onnxruntime](https://onnxruntime.ai/docs)
[torch](https://pytorch.org/docs)
[ultralytics](https://github.com/ultralytics/ultralytics)

## Метрики
### Бизнес метрики

    Безопасность и снижение рисков:
        Снижение инцидентов: Измерение эффективности системы в снижении инцидентов, связанных с упущенными или неправильно распознанными знаками, что может способствовать общей безопасности.
        
    Операционная эффективность:
        Время обработки: Время, необходимое системе для обнаружения знаков. Более быстрое время обработки может быть решающим, особенно в приложениях в реальном времени.

    Эффективность затрат:
        Использование ресурсов: Использование вычислительных ресурсов. Эффективное использование ресурсов может привести к экономии затрат.

    Удовлетворенность клиентов:
        Пользовательский опыт: Оценка влияния на пользовательский опыт, особенно в приложениях, где пользователи взаимодействуют с системой распознавания знаков. Положительный опыт пользователя может привести к удовлетворенности клиентов.

    Оптимизация бизнес-процессов:
        Улучшение рабочего процесса: Оцените, как система распознавания знаков способствует оптимизации бизнес-процессов или рабочих потоков.

    Стоимость ошибок:
        Воздействие ложных срабатываний/пропусков: Бизнес-затраты, связанные с ложными срабатываниями (неправильное обнаружение знаков) и ложными пропусками (пропуск знаков). Это может быть связано с безопасностью, штрафами за нарушение или другими факторами.

    Масштабируемость:
        Масштабируемость системы: Способность системы распознавания знаков масштабироваться с увеличением потребностей бизнеса.

    Окупаемость вложений (ROI):
        Финансовое воздействие: Измерение финансового воздействия внедрения системы распознавания знаков, учитывая как затраты, так и выгоды.

    Затраты на обучение и обслуживание:
        Затраты на обучение: Оценка стоимости и времени, необходимых для обучения персонала использованию и обслуживанию системы распознавания знаков.

    Адаптивность:
        Приспособляемость к изменениям: Оценка, насколько легко система распознавания знаков может адаптироваться к изменениям в знаках, условиях окружающей среды или другим переменным.

Эти бизнес-метрики соответствуют общим целям организации и помогают определить общий эффект и успех системы распознавания знаков в контексте бизнеса.

### Метрики обнаружения объектов

    (IoU): IoU — это мера, которая количественно определяет перекрытие между прогнозируемыми ограничивающими bboxes и истинными ограничивающими bboxes. Она играет фундаментальную роль в оценке точности локализации объекта.

    Средняя точность (AP): AP вычисляет площадь под кривой точности (Precision) и полноты (Recall), предоставляя одно значение, которое отражает точность модели и производительность полноты.

    (mAP): mAP расширяет концепцию AP, вычисляя средние значения AP для нескольких классов объектов. Это полезно в сценариях обнаружения объектов с несколькими классами, чтобы обеспечить всестороннюю оценку производительности модели.

    Precision и Recall. Precision определяет долю истинных положительных результатов среди всех положительных прогнозов, оценивая способность модели избегать ложных положительных результатов. С другой стороны, Recall вычисляет долю истинно положительных результатов среди всех фактических положительных результатов, измеряя способность модели обнаруживать все экземпляры класса.

    Оценка F1: Оценка F1 — это гармоническое среднее между значениями Precision и Recall, обеспечивающее сбалансированную оценку производительности модели с учетом как ложноположительных, так и ложноотрицательных результатов.

| Метрика             | Описание                                                                                             |
|---------------------|------------------------------------------------------------------------------------------------------|
| Precision (Точность)        | Точность обнаруженных объектов, указывает, сколько обнаружений были правильными.                   |
| Recall (Полнота)          | Способность модели идентифицировать все экземпляры объектов на изображениях.                       |
| mAP@50               | Средняя точность, рассчитанная при пороге IoU = 0,50. Мера точности модели, учитывающая только "легкие" обнаружения. |
| mAP@50-95            | Среднее значение средней точности, рассчитанной при различных порогах IoU от 0,50 до 0,95. Предоставляет всесторонний обзор производительности модели на разных уровнях сложности обнаружения. |

| Выбор правильных метрик             | Выбор подходящих метрик для оценки часто зависит от конкретного применения                                                                                             |
|---------------------|------------------------------------------------------------------------------------------------------|
| mAP                 | Подходит для общей оценки производительности модели.                                              |
| IoU                 | Необходим при точном определении местоположения объектов.                                        |
| Точность            | Важна при минимизации ложных обнаружений.                                                        |
| Полнота             | Критична, когда важно обнаружить каждый экземпляр объекта.                                       |
| F1 Score            | Полезна при необходимости баланса между точностью и полнотой.                                    |
| Для приложений в реальном времени | Метрики скорости, такие как FPS (кадры в секунду) и задержка, критичны для обеспечения своевременных результатов. |

| Интерпретация результатов             | Часто наблюдаемые низкие показатели и их возможные интерпретации                                                                                             |
|---------------------|------------------------------------------------------------------------------------------------------|
| Низкий mAP           | Указывает на то, что модель может требовать общих улучшений.                                     |
| Низкий IoU           | Модель может испытывать трудности в точном определении местоположения объектов. Методы разметки границ могут помочь. |
| Низкий Precision      | Модель может обнаруживать слишком много несуществующих объектов. Подстройка порогов уверенности может уменьшить это. |
| Низкий Recall        | Модель может упускать настоящие объекты. Улучшение извлечения признаков или использование большего объема данных может помочь. |
| Несбалансированный F1 Score | Имеется неравенство между точностью и полнотой.                                       |
| Class-specific AP    | Низкие баллы могут выявить классы, с которыми модель имеет трудности.                            |

## Установка
YOLOv8 требует [ultralytics](https://github.com/ultralytics/ultralytics) v8.0.215+ для запуска.

Установка зависимостей и devDependencies и запуск сервера.

```sh
cd yolo
npm i
node app
```

For production environments...

```sh
npm install --production
NODE_ENV=production node app
```


## Development
Хотите внести свой вклад? Великолепно!
Внесите изменения в наш файл и скоро же увидите свои обновления, если они соответствуют каким-либо улучшениям проекта!


#### Building for source

Для выпуска продукции:

```sh
??? build --prod-->
```

Создание готовых zip-архивов для распространения:

```sh
??? build dist --prod
```

## Docker

Наша модель проста в установке и деплое в Докер контейнере.

По умолчанию Docker предоставляет порт 8080, поэтому измените его в
Dockerfile при необходимости. Когда все будет готово, просто используйте Dockerfile для построения образа.

```sh
cd yolo
docker build -t <youruser>/yolo:${???.version} .
```

Это создаст образ ??? и подключит необходимые зависимости.
Обязательно замените `${???.version}` на фактическую
версию ???.

После этого запустите образ Docker и сопоставьте порт с любым желаемым портом.
В этом примере мы просто сопоставляем порт 8000 хоста с портом 8080 Docker (или любым другим портом, указанным в Dockerfile):

```sh
docker run -d -p 8000:8080 --restart=always --cap-add=SYS_ADMIN --name=yolo <youruser>/yolo:${???.version}
```

> Note: `--capt-add=SYS-ADMIN` is required for PDF rendering.

Проверьте развертывание, перейдя по адресу вашего сервера в
предпочитаемом вами браузере.

```sh
127.0.0.1:8000
```

## Лицензия

**Sigma Intelligence**

   [russian-traffic-signs-recognition dataset]: <https://universe.roboflow.com/mguogareva/russian-traffic-signs-recognition/model/1>
